FROM debian:buster

RUN apt update -y && apt update

RUN apt install curl -y

RUN apt -y install php php7.3-fpm php7.3-mysql

WORKDIR /var/www/html/wordpress

RUN chown -R www-data:www-data /var/www/html/wordpress

# Download wp-cli
RUN curl -O https://raw.githubusercontent.com/wp-cli/builds/gh-pages/phar/wp-cli.phar

# Make it executable
RUN chmod +x wp-cli.phar

# Move it into /usr/local/bin/wp
RUN mv wp-cli.phar /usr/local/bin/wp

RUN wp core download --allow-root --path='/var/www/html/wordpress'

RUN wp core config --dbname='wordpress' --dbuser='db_user' --url='localhost' --path='/var/www/html/wordpress' --allow-root

CMD [ "php-fpm7.3", "-F", "-R"]